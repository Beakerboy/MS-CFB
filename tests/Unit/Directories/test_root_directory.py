import pytest
from ms_cfb.Models.Directories.root_directory import RootDirectory


def test_directory():

    dir = RootDirectory()
    dir.name = "Root Entry"
    assert dir.name_size() == 22

    dir._Directory_subdirectory_id = 8
    dir.set_modified(0x01D92433C2B823C0)
    dir.set_start_sector(3)
    dir.color = 0

    ex = (b''
          + b'\x52\x00\x6F\x00\x6F\x00\x74\x00\x20\x00\x45\x00\x6E\x00\x74\x00'
          + b'\x72\x00\x79\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
          + b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
          + b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
          + b'\x16\x00\x05\x00\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\x08\x00\x00\x00'
          + b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
          + b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xC0\x23\xB8\xC2'
          + b'\x33\x24\xD9\x01\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
          + b'')

    assert dir.to_bytes() == ex


def test_add_created():
    dir = RootDirectory()
    with pytest.raises(Exception):
        date = 0x12345
        dir.set_created(date)
